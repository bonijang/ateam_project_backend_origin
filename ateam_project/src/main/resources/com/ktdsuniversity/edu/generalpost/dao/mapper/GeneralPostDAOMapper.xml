<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ktdsuniversity.edu.generalpost.dao.GeneralPostDAO">
	
	<insert id="createNewBoard"
			parameterType="com.ktdsuniversity.edu.generalpost.vo.GeneralPostVO">
		INSERT INTO GENERAL_POST 
			(GENERAL_POST_ID
			, POST_WRITER_ID
			, BOARD_ID
			, POST_TITLE
			, POST_CONTENT
			, POST_DATE
			, LIKE_CNT
			, VIEW_CNT
			, DELETE_YN) 
		VALUES 
		 (SEQ_GENERAL_POST_PK.NEXTVAL
	        , #{postWriterId}
			, 'CM-20231008-000029' 
			, #{postTitle}
			, #{postContent}
			, SYSDATE
			, 0
			, 0
			, 'N' )
	</insert>
	
	<select id="getBoardAllCount"
			resultType="_int">
		SELECT COUNT(1)
		  FROM GENERAL_POST
	</select>
	
	<update id="increaseViewCount"
			parameterType="_int">
		UPDATE GENERAL_POST
		   SET VIEW_CNT = VIEW_CNT + 1
		 WHERE GENERAL_POST_ID = #{_parameter}
	</update>
	
	<select id="getOneBoard"
		parameterType="string"
		resultType="com.ktdsuniversity.edu.generalpost.vo.GeneralPostVO">
		SELECT GENERAL_POST_ID
		     , POST_WRITER_ID
		     , BOARD_ID
		     , POST_TITLE
		     , POST_CONTENT
		     , POST_DATE
		     , LIKE_CNT
		     , VIEW_CNT
		     , DELETE_YN
		  FROM GENERAL_POST
		 WHERE GENERAL_POST_ID = #{_parameter}
	</select>
	
	<select id="getAllBoard"
	resultType="com.ktdsuniversity.edu.generalpost.vo.GeneralPostVO">
		SELECT GENERAL_POST_ID
		     , POST_WRITER_ID
		     , BOARD_ID
		     , POST_TITLE
		     , POST_CONTENT
		     , POST_DATE
		     , LIKE_CNT
		     , VIEW_CNT
		     , DELETE_YN
		  FROM GENERAL_POST
		 WHERE DELETE_YN = 'N'
		 ORDER BY POST_DATE DESC
	</select>

	
	<update id="updateOneBoard"
		parameterType="com.ktdsuniversity.edu.generalpost.vo.GeneralPostVO">
		UPDATE GENERAL_POST
		   SET POST_TITLE = #{postTitle}
		     , POST_CONTENT = #{postContent}
		     , POST_DATE = SYSDATE
		 WHERE GENERAL_POST_ID = #{generalPostId}
	</update>

	
	<!-- 삭제,근데 수정. -->
    <update id="deleteOneBoard"
	parameterType="com.ktdsuniversity.edu.generalpost.vo.GeneralPostVO">
		UPDATE GENERAL_POST
		   SET DELETE_YN = 'Y'
		 WHERE GENERAL_POST_ID = #{generalPostId}
	</update>
	
	
</mapper>